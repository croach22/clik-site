---
---

<div id="founding-banner" class="fixed top-0 left-0 right-0 z-[60] h-10 overflow-hidden">
  <canvas id="founding-canvas" class="absolute inset-0 w-full h-full"></canvas>
  <a href="/founding-creators" class="relative z-10 flex items-center justify-center h-full px-10 text-sm font-medium text-brand-cream/90 hover:text-white transition-colors">
    <span class="hidden sm:inline">Founding Creator Program — Free access + 30% lifetime commission →</span>
    <span class="sm:hidden">Founding Creators — Free access + 30% commission →</span>
  </a>
  <button
    id="founding-banner-close"
    class="absolute right-3 top-1/2 -translate-y-1/2 z-10 text-brand-cream/40 hover:text-brand-cream transition-colors text-lg leading-none"
    aria-label="Dismiss banner"
  >&times;</button>
</div>

<script>
  const BANNER_HEIGHT = 40;
  const banner = document.getElementById('founding-banner') as HTMLDivElement;
  const canvas = document.getElementById('founding-canvas') as HTMLCanvasElement;
  const closeBtn = document.getElementById('founding-banner-close');
  const nav = document.querySelector('nav') as HTMLElement;

  function setBannerVisible(visible: boolean, animate = false) {
    if (animate) {
      if (nav) nav.style.transition = 'top 0.4s cubic-bezier(0.4, 0, 0.2, 1)';
      document.body.style.transition = 'padding-top 0.4s cubic-bezier(0.4, 0, 0.2, 1)';
    }
    if (nav) nav.style.top = visible ? `${BANNER_HEIGHT}px` : '0px';
    document.body.style.paddingTop = visible ? `${BANNER_HEIGHT}px` : '0px';
  }

  if (sessionStorage.getItem('founding-banner-dismissed')) {
    banner.style.display = 'none';
    setBannerVisible(false);
  } else {
    setBannerVisible(true);
  }

  closeBtn?.addEventListener('click', () => {
    banner.style.transition = 'transform 0.4s cubic-bezier(0.4, 0, 0.2, 1), opacity 0.4s ease';
    banner.style.transform = 'translateY(-100%)';
    banner.style.opacity = '0';
    setBannerVisible(false, true);
    sessionStorage.setItem('founding-banner-dismissed', '1');
    setTimeout(() => { banner.style.display = 'none'; }, 400);
  });

  // --- Floating gold spores with mouse follow ---
  const ctx = canvas.getContext('2d')!;
  let w = 0, h = 0;
  const COUNT = 150;

  let mouseX = -1, mouseY = -1;
  let smoothMX = -1, smoothMY = -1;
  let mouseIn = false;

  banner.addEventListener('mousemove', (e) => {
    const rect = canvas.getBoundingClientRect();
    mouseX = e.clientX - rect.left;
    mouseY = e.clientY - rect.top;
    mouseIn = true;
  });
  banner.addEventListener('mouseleave', () => { mouseIn = false; });

  interface Spore {
    x: number; y: number;
    size: number; opacity: number;
    driftX: number; driftY: number;
    phase: number; freq: number; amp: number;
    glow: number; depth: number;
  }

  let spores: Spore[] = [];

  function resize() {
    const dpr = window.devicePixelRatio || 1;
    const rect = canvas.getBoundingClientRect();
    w = rect.width;
    h = rect.height;
    canvas.width = w * dpr;
    canvas.height = h * dpr;
    ctx.setTransform(dpr, 0, 0, dpr, 0, 0);
    if (spores.length === 0) initSpores();
  }

  function initSpores() {
    spores = [];
    for (let i = 0; i < COUNT; i++) {
      const depth = Math.random();
      spores.push({
        x: Math.random() * w,
        y: Math.random() * h,
        size: 0.4 + depth * 1.6,
        opacity: 0.08 + depth * 0.3,
        driftX: (Math.random() - 0.5) * 0.12,
        driftY: -(0.05 + Math.random() * 0.2) * (0.3 + depth * 0.7),
        phase: Math.random() * Math.PI * 2,
        freq: 0.3 + Math.random() * 1.0,
        amp: 0.3 + Math.random() * 1.0,
        glow: 2 + depth * 5,
        depth,
      });
    }
  }

  let t = 0;

  function draw() {
    t += 0.008;

    // Smooth mouse
    if (mouseIn && mouseX >= 0) {
      if (smoothMX < 0) { smoothMX = mouseX; smoothMY = mouseY; }
      else { smoothMX += (mouseX - smoothMX) * 0.1; smoothMY += (mouseY - smoothMY) * 0.1; }
    } else {
      smoothMX = -1; smoothMY = -1;
    }

    ctx.clearRect(0, 0, w, h);
    ctx.fillStyle = '#0a080d';
    ctx.fillRect(0, 0, w, h);

    for (let i = 0; i < spores.length; i++) {
      const s = spores[i];

      let mx = s.driftX + Math.sin(t * s.freq + s.phase) * s.amp * 0.12;
      let my = s.driftY + Math.cos(t * s.freq * 0.7 + s.phase) * 0.04;

      // Mouse attraction
      if (smoothMX >= 0) {
        const dx = smoothMX - s.x;
        const dy = smoothMY - s.y;
        const dist = Math.sqrt(dx * dx + dy * dy);
        const pull = Math.max(0, 1 - dist / 100);
        const str = pull * pull * 0.35 * s.depth;
        mx += dx * str * 0.02;
        my += dy * str * 0.02;
      }

      s.x += mx;
      s.y += my;

      if (s.y < -4) { s.y = h + 2; s.x = Math.random() * w; }
      if (s.y > h + 4) { s.y = -2; s.x = Math.random() * w; }
      if (s.x < -4) s.x = w + 2;
      if (s.x > w + 4) s.x = -2;

      // Mouse proximity brightness boost
      let mouseBoost = 0;
      if (smoothMX >= 0) {
        const dx = smoothMX - s.x;
        const dy = smoothMY - s.y;
        const dist = Math.sqrt(dx * dx + dy * dy);
        mouseBoost = Math.max(0, 1 - dist / 100);
        mouseBoost *= mouseBoost;
      }

      const pulse = Math.sin(t * 0.8 + s.phase) * 0.06;
      const alpha = Math.min(1, Math.max(0.03, s.opacity + pulse + mouseBoost * 0.5));

      const r = Math.floor(200 + s.depth * 55);
      const g = Math.floor(170 + s.depth * 40);
      const b = Math.floor(80 + (1 - s.depth) * 100);

      ctx.shadowColor = `rgba(${r}, ${g}, ${b}, ${alpha * 0.6})`;
      ctx.shadowBlur = s.glow + mouseBoost * 6;

      ctx.beginPath();
      ctx.arc(s.x, s.y, s.size + mouseBoost * 1, 0, Math.PI * 2);
      ctx.fillStyle = `rgba(${r}, ${g}, ${b}, ${alpha})`;
      ctx.fill();
    }

    ctx.shadowColor = 'transparent';
    ctx.shadowBlur = 0;

    requestAnimationFrame(draw);
  }

  resize();
  draw();
  window.addEventListener('resize', resize);
</script>
